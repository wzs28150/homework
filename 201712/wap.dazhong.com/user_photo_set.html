<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>首页 - 大众商城</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no, email=no" />
  <link rel="stylesheet" href="./src/css/me.css">
  <link href="./src/scripts/package/photo/css/style.css" rel="stylesheet" type="text/css">
  <!--[if IE]>
<script src="js/html5shiv.min.js"></script>
<![endif]-->
</head>

<body style="background:#eee">
  <!--头部-->
  <header id="user_head">
    <div class="container_1200">
      <a class="jt-chevron-left left-ico" href="javascript:history.back();"></a>
      <h1>头像修改</h1>
    </div>
  </header>
  <a href="javascript:void(0);" class="logoBox" id="logoBox">
    <img id="bgl" src="./src/images/my_photo.png" width="100%">
  </a>


  <div class="htmleaf-container" style="display: block;">
    <div id="clipArea"></div>
    <div id="view"></div>
  </div>


  <div class="btn-1">
    <button>确认更换</button>
  </div>

  <div id="dpage" class="show">
    <a href="javascript:void(0);"><input type="button" name="file" class="button" value="选取照片">
	  <input id="file" type="file" accept="image/*" multiple  /></a>
    <a href="javascript:void(0);" class="qx"><button id="clipBtn">截取图片</button></a>
  </div>

  <script src="./src/scripts/package/photo/js/jquery.min.js" type="text/javascript"></script>
  <script>
    window.jQuery || document.write('<script src="./src/scripts/package/photo/js/jquery-2.1.1.min.js"><\/script>')
  </script>
  <script src="./src/scripts/package/photo/js/iscroll-zoom.js"></script>
  <script src="./src/scripts/package/photo/js/hammer.js"></script>
  <script src="./src/scripts/package/photo/js/jquery.photoClip.js"></script>
  <script>
    var obUrl = ''
    //document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    $("#clipArea").photoClip({
      width: 280,
      height: 280,
      file: "#file",
      view: "#view",
      ok: "#clipBtn",
      loadStart: function() {
        console.log("照片读取中");
      },
      loadComplete: function() {
        console.log("照片读取完成");
      },
      clipFinish: function(dataURL) {

        console.log(dataURL)
        $('body').off('click', '.btn-1 button').on('click', '.btn-1 button', function(event) {
          event.preventDefault();
          //dataURL 就是图片路径直接用ajax  post方法发送给php就行 图片采用 base64格式 无实体图片全由代码表示 字段长度要长
          //切图测试我使用get 做的时候用下面post
          $.get("./src/scripts/package/photo/1.json", {}, function(data) {
            history.back();
          }, "text");

          //正式使用post提交php
          // $.post("php路径", {'photo',dataURL},function(data) {
          //     //我这里简单写了一个返回 你需要判断 php存成功了之后 返回
          //     history.back();
          //   },"text");
        });
      }
    });
  </script>
  <script src="./src/scripts/package/photo/js/touxiang.js"></script>

</body>

</html>
