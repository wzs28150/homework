<!DOCTYPE html>
<!--[if lte IE 9]> <html lang="en" class="no-js lte-ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>首页 - 大众商城</title>
  <link rel="stylesheet" href="./src/css/me.css">
  <link rel="stylesheet" href="./src/css/products.css">
  <script src="./src/scripts/package/jquery/jquery-1.9.1.min.js"></script>
  <!--[if IE 8]>
  <script src="./src/scripts/package/compat/html5shiv.js"></script>
  <script src="./src/scripts/package/compat/respond.js"></script>
<![endif]-->
</head>

<body class="hasheader">
  <!-- 弹窗 -->
  <div class="alert_player" style="display:none;">
    <div class="bg"></div>
    <div class="layer">
      <div class="info"></div>
      <a class="queren_btn" data-ajax="no">确认</a>
    </div>
  </div>
  <!-- 弹窗 -->
  <header>
    <div class="container_1200">
      <a class="jt-chevron-left" href="javascript:history.back();"></a>
      <h1>产品中心</h1>
    </div>
  </header>
  <main>
    <article class="products">

    </article>
  </main>
  <!-- 此处调用公共底部footer 做程序时可换对应代码 -->
  <div id="footer" class="jiazai" data-callback="navactive:1,minheight"></div>
  <!-- 此处调用公共底部footer 做程序时可换对应代码 -->
  </div>
  <!-- 动画插件 -->
  <script src="./src/scripts/package/viewport/jquery.viewport.js"></script>
  <!-- 动画插件 -->
  <!-- 一些主要的公共方法  -->
  <script src="./src/scripts/lib/main.js"></script>
  <!-- 一些主要的公共方法  -->
  <!-- banner滚动插件 -->
  <!-- banner滚动插件 -->
  <!-- 滚动加载-->
  <script src="./src/scripts/package/dropload/dropload.min.js"></script>
  <!-- 滚动加载-->
  <script type="text/javascript">
    //ajax 滚动加载 数据是网上找的测试数据 没有价格 自己替换
    //接口格式http://ons.me/tools/dropload/json.php?page=0&size=4
    $(function() {
      // 页数
      var page = 0;
      // 每页展示5个
      var size = 4;

      // dropload
      $('.pro-list').dropload({
        scrollArea: window,
        loadDownFn: function(me) {
          page++;
          // 拼接HTML
          var result = '';
          $.ajax({
            type: 'GET',
            url: 'http://ons.me/tools/dropload/json.php?page=' + page + '&size=' + size,
            dataType: 'json',
            success: function(data) {
              var arrLen = data.length;
              if (arrLen > 0) {
                for (var i = 0; i < arrLen; i++) {
                  result += '<div class="item animate-element  bottom-to-top fl in-viewport">' +
                            '<div class="pic" style="background-image:url(' + data[i].pic + ')"><a href="' + data[i].link + '"></a></div>' +
                            '<div class="price">￥<span>238.00</span></div>' +
                            '<div class="title"><a href="' + data[i].link + '">' + data[i].title + '</a></div>' +
                            '<div class="btn felx-box">' +
                            '<a class="brand-sc felx-item" href="">收藏</a><a class="brand-car felx-item" href="">加入购物车</a>' +
                            '</div>' +
                            '</div>';
                }
                // 如果没有数据
              } else {
                // 锁定
                me.lock();
                // 无数据
                me.noData();
              }
              // 为了测试，延迟1秒加载
              setTimeout(function() {
                // 插入数据到页面，放到最后面
                $('.lists').append(result);
                // 每次数据插入，必须重置
                me.resetload();
              }, 1000);
            },
            error: function(xhr, type) {
              alert('Ajax error!');
              // 即使加载出错，也得重置
              me.resetload();
            }
          });
        }
      });
    });
  </script>


</body>

</html>
